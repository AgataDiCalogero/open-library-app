<div class="space-y-6">
  <!-- Back -->
  <button
    type="button"
    class="btn btn-outline"
    (click)="back.emit()"
  >
    <app-icon name="arrow-left" [size]="16" />
    Back
  </button>

  <!-- Header -->
  <div class="flex flex-col gap-6 sm:flex-row sm:items-start">
    <!-- Cover -->
    <div class="h-48 w-32 shrink-0 overflow-hidden rounded-2xl bg-wash/70 shadow-sm sm:h-56 sm:w-40">
      @if (coverUrl(); as url) {
      <img class="h-full w-full object-cover" [src]="url" [alt]="work().title" loading="lazy" />
      }
    </div>

    <!-- Title + Authors -->
    <div class="min-w-0 space-y-3">
      <h1 class="text-2xl font-semibold leading-tight text-ink sm:text-3xl wrap-anywhere">
        {{ work().title }}
      </h1>

      <p class="text-sm text-ink/70">
        <span class="font-medium text-ink">Authors:</span>
        {{ summary()?.authors || 'Unknown' }}
      </p>

      <div class="w-full rounded-xl border border-ink/10 bg-white/70 p-3 sm:max-w-md">
        <ul class="space-y-1 text-sm text-ink/70">
          @for (entry of metaEntries(); track entry.label) {
          <li class="flex items-start gap-2">
            <span class="min-w-20 font-medium text-ink">{{ entry.label }}:</span>
            <span class="min-w-0">{{ entry.value }}</span>
          </li>
          }
        </ul>
      </div>

      @if (subjectChips(); as chips) {
      @if (chips.visible.length) {
      <div class="space-y-2 pt-1">
        <h2 class="text-xs font-semibold uppercase tracking-[0.24em] text-ink/60">Categories</h2>
        <div class="flex flex-wrap gap-2">
          @for (subject of chips.visible; track subject) {
          <span class="chip chip--neutral chip--truncate" [attr.title]="subject">
            {{ subject }}
          </span>
          }
          @if (chips.canToggle) {
          <button type="button" class="chip chip--muted chip--interactive" (click)="toggleSubjects()">
            @if (chips.expanded) { Show less } @else { +{{ chips.hiddenCount }} more }
          </button>
          }
        </div>
      </div>
      }
      }
    </div>
  </div>

  <!-- Description -->
  <section class="rounded-2xl border border-ink/10 bg-white/80 p-5 shadow-sm">
    <h2 class="text-base font-semibold text-ink">Description</h2>

    @if (work().description; as desc) {
    <p class="mt-3 max-w-4xl whitespace-pre-line text-sm leading-relaxed text-ink/80 wrap-anywhere 2xl:max-w-5xl">
      {{ desc }}
    </p>
    } @else {
    <p class="mt-3 text-sm text-ink/60">No description available.</p>
    }

    <div class="mt-4 flex justify-end">
      <a
        class="btn btn-primary w-full sm:w-auto"
        [href]="work().openLibraryUrl"
        target="_blank"
        rel="noopener noreferrer"
      >
        Open on Open Library
        <app-icon name="external-link" [size]="16" />
      </a>
    </div>
  </section>
</div>
